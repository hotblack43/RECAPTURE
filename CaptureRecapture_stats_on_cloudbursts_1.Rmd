---
title: "Estimate number of clousbursts with the Capture Recapture method"
output: html_notebook
---

We know of the rate or numbe rof cloudbursts in Denmark only from the observation stationnetwork. Many cloudbursts must be ocurring without being observed. Can we use the Capture recapture method to estimate the actual number of cloudbursts?

```{r}
rm(list=ls())
library(Rcapture)
```

# Set up CB-data
```{r}
df <- readRDS("../EkstremRegn/OUTPUT/joined_up_data_SVKRP1.rds")
rownames(df) <- NULL
dicot <- df[,6]
n <- length(dicot)
capture <- cbind.data.frame((1:n),dicot) 
```

# some Capture Release Recapture cycles
```{r}
ncycles <- 4
for (icyc in 1:ncycles){  capture <- cbind(capture,((1:n)*0))}
ncapture <- n/16
for (icycle in 1:ncycles)
{
  # capture pointers
  idx <- sample(1:n,ncapture,replace=FALSE)
  caught1s <- idx[which(capture[idx,2] == 1)]
  # mark them
  capture[caught1s,2+icycle] <- 1
}
# collect those that are truly 1s
capture_history <- capture[which(capture[,2] == 1),3:6]
rownames(capture_history) <- NULL
colnames(capture_history) <- c("c1","c2","c3","c4")
```

# run test 
```{r}
X <- as.matrix(capture_history)
ex <- closedp(X)
ex$results
```




